# MVP 阶段性汇报与工作日志

**版本截止**: v0.3.2
**时间范围**: 2026-01-19 至 2026-02-02

---

## 🚀 1. 项目整体进度汇报 (MVP 完成)

本项目已完成 MVP (Minimum Viable Product) 开发，并快速迭代至 v0.3.2 版本，成功打通了时序数据从采集到多模态检测的全链路闭环。

### 核心功能模块
*   **数据采集 (Data Acquisition)**:
    *   支持从 IoTDB 批量读取数据，具备 **Level 3 兜底机制**（本地文件缺失时自动拉取）。
    *   支持数据自动降采样和标准化命名 (`v0.2.3`)。
*   **数据标注 (Annotation)**:
    *   集成 Web 标注工具，支持时序异常区间的可视化标注。
    *   新增 **算法预标注加载**：支持加载 "ChatTS" 和 "Qwen" 的检测结果，并以不同颜色（粉紫色）区分显示 (`v0.2.2`)。
*   **模型微调 (Training)**:
    *   集成 **LLaMA-Factory** 框架，建立了统一的微调服务。
    *   支持 **ChatTS-14B/8B** 和 **Qwen3-VL** (`v0.3.0`) 的 LoRA/QLoRA 微调。
*   **推理检测 (Inference)**:
    *   **ChatTS**: 基于与语言模型的时序异常检测。
    *   **Qwen-VL**: 新增 **多模态视觉语言模型** 检测能力，引入图像生成与 VLM 推理 (`v0.3.0`)。
    *   **自动化**: 结果自动同步至工作空间，实现“即生成即见”。

### 平台架构
*   **Monorepo 架构**: 统一管理前后端、微服务 (ilabel, training) 和共享配置，极大提升了跨模块协作效率。
*   **全链路闭环**: 打通了 `采集 -> 标注 -> 训练 -> 推理 -> 监控` 的迭代循环。

---

## 📅 2. 每日开发工作详情

### 🗓️ 开发日历 (2026.01)

| Mon | Tue | Wed | Thu | Fri | Sat | Sun |
| :---: | :---: | :---: | :---: | :---: | :---: | :---: |
| **19**<br>后端搭建<br>基础API | **20**<br>v0.1.0 发布<br>Monorepo重构 | **21**<br>Git冲突解决<br>环境稳定化 | **22**<br>推理Bug修复<br>运行时环境 | **23**<br>v0.2.1/v0.2.2<br>标注/UI优化 | **24**<br>*(休息)* | **25**<br>*(休息)* |
| **26**<br>Annotator修复<br>链路优化启动 | **27**<br>v0.3.0 Qwen集成<br>Level 3兜底 | | | | | |

---

### 2月2日 (v0.3.2 - 训练与对比体验优化)
> **阶段目标**: 提升训练与模型对比的选择体验，减少噪音与误选。

*   **训练界面优化**:
    *   新增训练方式过滤（lora/full/all），模板列表不再拥挤。
    *   模型类型与训练方式联动，快速切换训练模板。
*   **LoRA 适配器选择**:
    *   适配器选择改为“训练任务 + Checkpoint（可选）”两级。
    *   默认不展示 checkpoint，降低列表噪音。
*   **模型对比筛选**:
    *   新增模型类型/训练方式/是否包含 checkpoint 过滤。

### 1月27日 (v0.3.0 - 多模态集成) ⭐
> **阶段目标**: 突破纯时序限制，集成 Qwen-VL 多模态大模型。

*   **多模态推理集成**:
    *   开发 `qwen_detect.py`，实现时序数据转图像、Prompt 构建及 VLM 推理逻辑。
    *   升级 `run.py` 适配器，支持 `--method qwen`，实现与现有系统的无缝兼容。
*   **多模态训练集成**:
    *   创建 `train_qwen_vl.sh`，打通 LLaMA-Factory 的多模态微调链路。
*   **数据链路优化 (v0.2.3)**:
    *   实施 Level 3 数据兜底机制，增强系统鲁棒性。
    *   统一全局文件命名规范，并新增 `scripts/repair_data.py` 修复工具。
    *   抽离 `config/iotdb_config.json` 实现配置共享。

### 1月26日 (服务修复与架构设计)
> **阶段目标**: 解决标注服务访问问题，设计数据链路优化方案。

*   **Annotator 访问修复**:
    *   解决标注服务绑定地址 (`localhost` vs `0.0.0.0`) 问题，确保局域网可访问 (`192.168.199.126`)。
    *   修复推理结果文件在标注界面的可见性问题。
*   **Pipeline 架构设计**:
    *   规划 v0.2.3 的数据链路优化方案（Level 3 兜底）。
    *   确定新的统一文件命名规范 `{PointID}_{StartTime}_{EndTime}_{Algorithm}.csv`。

### 1月23日 (v0.2.1 / v0.2.2 - 体验优化)
> **阶段目标**: 提升标注与推理的用户体验。

*   **标注增强**:
    *   实现 CSV 自动可视化，打开文件即渲染波形与异常区间。
    *   新增 "算法结果" 动态标签分类。
*   **推理 UI 优化**:
    *   实现结果文件自动软链同步。
    *   新增批量下载与批量删除功能，优化任务管理交互。
    *   **交互细节优化**: 修复任务停止反馈逻辑，折叠任务历史面板以精简界面 (`v0.2.1`)。

### 1月22日 (推理服务调试)
> **阶段目标**: 修复推理模块运行错误，确保流程跑通。

*   **Bug 修复**:
    *   修复 Transformer 库版本导致的 `ImportError: LossKwargs`。
    *   修复 UI 组件定义缺失导致的启动崩溃。
    *   修正 `run.py` 参数解析逻辑。

### 1月21日 (联调与稳定)
> **阶段目标**: Monorepo 整合后的环境稳定化。

*   **冲突解决**: 处理 `ilabel` 子模块合并冲突。
*   **环境修复**: 统一各子模块的依赖版本。

### 1月20日 (MVP 发布 v0.1.0 -> v0.2.0)
> **阶段目标**: 完成核心功能闭环与 Monorepo 重构。

*   **v0.1.0 闭环**:
    *   实现推理结果自动反馈闭环逻辑。
    *   完成各服务模块的 API 联调。
*   **v0.2.0 重构**:
    *   确立 Monorepo 架构，整合所有子仓库。
    *   实现版本管理 API (`/api/v1/iteration`)。
    *   统一 WebUI 入口 (`training_ui.py`)。

### 1月19日 (基础设施搭建)
> **阶段目标**: 搭建后端框架与基础服务。

*   **基础架构**:
    *   搭建 FastAPI 后端项目骨架。
    *   配置 Celery 任务队列。
*   **服务开发**:
    *   完成数据、标注、微调三大服务的基础 API 开发。
    *   搭建 Gradio 微调参数配置界面雏形。
