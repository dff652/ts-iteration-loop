# TS-Iteration-Loop æ—¶åºå¼‚å¸¸æ£€æµ‹è¿­ä»£å¾ªç¯ç³»ç»Ÿ

> æ•´åˆæ•°æ®è·å–ã€æ ‡æ³¨ã€å¾®è°ƒã€æ¨ç†å››å¤§æ¨¡å—ï¼Œæ‰“é€šå…¨é“¾è·¯åé¦ˆé—­ç¯çš„ç»Ÿä¸€è¿­ä»£å¹³å°ã€‚

## é¡¹ç›®çŠ¶æ€

ğŸŸ¢ **Phase 3 å®Œæˆ** - å·²å®ç°æ¨ç†ç»“æœè‡ªåŠ¨å›ä¼ æ ‡æ³¨ç«¯çš„åé¦ˆé—­ç¯ï¼Œå¹¶æ”¯æŒå¤šæ¨¡å‹ç‰ˆæœ¬å¯¹æ¯”ã€‚

## æ ¸å¿ƒæµç¨‹ (åé¦ˆé—­ç¯)

```mermaid
graph LR
    A[æ•°æ®å¤„ç†] --> B[äººå·¥æ ‡æ³¨]
    B --> C[æ¨¡å‹å¾®è°ƒ]
    C --> D[æ¨¡å‹æ¨ç†]
    D -->|è‡ªåŠ¨è½¬æ¢ä¸ºé¢„æ ‡æ³¨| B
    C -->|å¤šç‰ˆæœ¬ Loss å¯¹æ¯”| E[è¯„ä¼°ä¸å†³ç­–]
```

## åŠŸèƒ½æ¨¡å—

| æ¨¡å— | çŠ¶æ€ | æŠ€æœ¯å®ç° |
|------|------|----------|
| **æ•°æ®æœåŠ¡** | âœ… å®Œæˆ | å°è£… `Data-Processing` è„šæœ¬ |
| **æ ‡æ³¨æœåŠ¡** | âœ… å®Œæˆ | é›†æˆ `timeseries-annotator-v2` |
| **å¾®è°ƒæœåŠ¡** | âœ… å®Œæˆ | Gradio UI å°è£… `ChatTS-Training`ï¼Œæ”¯æŒå¤šç‰ˆæœ¬å¯¹æ¯” |
| **æ¨ç†æœåŠ¡** | âœ… å®Œæˆ | å°è£… `check_outlier` é¡¹ç›® |
| **ä»»åŠ¡é˜Ÿåˆ—** | âœ… å®Œæˆ | Celery + Redis å¼‚æ­¥æ‰§è¡Œ |
| **è¿­ä»£åé¦ˆ** | âœ… å®Œæˆ | **[New]** æ¨ç†ç»“æœè‡ªåŠ¨å›æµæ ‡æ³¨ç«¯ä½œä¸ºé¢„æ ‡æ³¨ |

## ğŸš€ å¿«é€Ÿå¼€å§‹

### æ–¹å¼ 1ï¼šDocker éƒ¨ç½² (æ¨è)

```bash
cd /home/douff/ts/ts-iteration-loop
docker-compose up -d
```

### æ–¹å¼ 2ï¼šæœ¬åœ°å¯åŠ¨

```bash
# å®‰è£…ä¾èµ– (æ¨èä½¿ç”¨å›½å†…é•œåƒæº)
pip install -i https://pypi.tuna.tsinghua.edu.cn/simple -r requirements.txt

# å¯åŠ¨æ‰€æœ‰æœåŠ¡ (App + Celery Worker)
./scripts/start.sh all
```

è®¿é—®åœ°å€ï¼š
- **å¾®è°ƒ & å¯¹æ¯”ç•Œé¢**: [http://localhost:8000/train-ui](http://localhost:8000/train-ui)
- **API æ–‡æ¡£**: [http://localhost:8000/docs](http://localhost:8000/docs)

## ğŸ—ï¸ æ¶æ„æ¦‚è§ˆ

- **Backend**: FastAPI (Python)
- **Forwarding UI**: Gradio (å¾®è°ƒçŠ¶æ€ã€è¿›åº¦ç›‘æ§ã€å¤šæ¨¡å‹ Loss æ›²çº¿å¯¹æ¯”)
- **Worker**: Celery (å¤„ç†è€—æ—¶è®­ç»ƒ/æ¨ç†)
- **Storage**: SQLite (ä»»åŠ¡çŠ¶æ€ç®¡ç†) + Redis (ä»»åŠ¡ Broker)

## ğŸ“ ä¸»è¦ç›®å½•

```text
ts-iteration-loop/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ api/            # æ ¸å¿ƒä¸šåŠ¡æ¥å£
â”‚   â”œâ”€â”€ adapters/       # å¤–éƒ¨å­é¡¹ç›®é€‚é…å™¨
â”‚   â”œâ”€â”€ core/           # ä»»åŠ¡å¼•æ“ä¸è¿›åº¦ç›‘æ§
â”‚   â”œâ”€â”€ webui/          # Gradio è®­ç»ƒä¸å¯¹æ¯”ç•Œé¢
â”‚   â””â”€â”€ main.py         # ç»Ÿä¸€å…¥å£
â”œâ”€â”€ scripts/            # å¯åŠ¨è„šæœ¬ä¸é›†æˆæµ‹è¯• (test_feedback_loop.py)
â””â”€â”€ docs/               # è¯¦ç»†å¼€å‘æ–‡æ¡£ä¸ API è¯´æ˜
```

---

## ç›¸å…³èµ„æº

- [å¼€å‘æ—¥å¿—ä¸é‡Œç¨‹ç¢‘](docs/DEVELOPMENT.md)
- [API è¯¦ç»†è¯´æ˜](docs/API.md)
- [æ¨ç†åé¦ˆå›è·¯è®¾è®¡](docs/DEVELOPMENT.md#phase-3-è¿›å±•)

---
GitHub: [dff652/ts-iteration-loop](https://github.com/dff652/ts-iteration-loop)
